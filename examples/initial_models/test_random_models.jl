### A Pluto.jl notebook ###
# v0.19.32

using Markdown
using InteractiveUtils

# ╔═╡ 15678f68-882c-11ee-05ce-fd760daebd8d
# ╠═╡ show_logs = false
begin
	using Pkg; Pkg.activate(".")
	using TSO
	using MUST
	using Plots
	using Printf
	using DataFrames
	using DelimitedFiles 
	using LazySets
	using Polyhedra
end

# ╔═╡ dc53b3e9-ab5f-4d14-828b-5fc961faf37d
modelgrids = MUST.ingredients("modelgrids.jl")

# ╔═╡ bc1caffd-1787-40b3-8ba0-68a3eafe09b3
staggergrid = MUST.StaggerGrid("stagger_grid_full.mgrid")

# ╔═╡ bf868bbc-a51f-4d3a-9357-64d2eb05addd
randomgrid = MUST.StaggerGrid("random_grid.mgrid")

# ╔═╡ 8a44b83c-eeea-4224-a7ef-52d98895fa9f
eos_folder = "/u/peitner/DISPATCH/TSO.jl/examples/binning_opacities/tables/TSO_MARCS_v1.6"

# ╔═╡ 0bd5a63d-e047-493a-ba9c-e17b4de9e674
eos_E_folder = "DIS_MARCS_E_t57.91g41.62m0.000_v0.1"

# ╔═╡ 9de39e0c-7525-42d3-86ac-2e5c06e37759
i_test = findfirst(randomgrid["name"] .== "t57.91g41.62m0.000")

# ╔═╡ 4ce7b47f-f8b8-400e-9c41-4c1b0b09046a
edges = [
	i for i in 1:nrow(staggergrid.info) 
	if staggergrid["name", i] ∈ ["t45g40m00", "t45g45m00", "t50g40m00", "t50g45m00", "t50g45p05"]
]

# ╔═╡ 01d636c2-db4d-45af-8a04-0af50443fe64


# ╔═╡ 3b36e263-fef2-4c16-8c68-b20dbca3c34d
eos = reload(SqEoS, joinpath(eos_folder, "combined_ross_eos_magg22.hdf5"))

# ╔═╡ 7fe10125-30be-48d0-9b7a-5987e1718786
eosE = reload(SqEoS, joinpath(eos_E_folder, "eos.hdf5"))

# ╔═╡ c8578ef3-4eaa-4b51-8802-2557b78c6aa5
opa = reload(
	SqOpacity, 
	joinpath(eos_folder, "combined_opacities_magg22.hdf5"), 
	mmap=true
)

# ╔═╡ 6fe9c410-f5f4-459a-bfe7-7adde931838c


# ╔═╡ fc9e065d-c19a-4edb-95a7-322ac5a575b4
model = @optical(
	Average3D(eos, randomgrid["av_path", i_test], logg=randomgrid["logg", i_test]), eos, opa
)

# ╔═╡ a2da7fef-8afb-4f73-898f-944122dff5f3
models_stagger = [
	@optical(
		Average3D(eos, staggergrid["av_path", i], logg=staggergrid["logg", i]), eos, opa
	)
	for i in edges
]

# ╔═╡ 171e7f10-8d6d-4670-9c92-5027efb0ce29


# ╔═╡ fc5cc62a-0fa2-4b45-b511-ab6040cdeef3
adbt(model) = begin
	m = TSO.flip(model)
	s = TSO.pick_point(m, 1)
	e = TSO.pick_point(m, length(m.z))
	@show s.logg
	TSO.adiabat(
		s, e, eosE, dlnd=0.05, n_iter=50, 
		ee_min=exp.(lookup(eos, :lnEi, e.lnρ[1], e.lnT[1]))
	)
end

# ╔═╡ e3f4417e-9aa2-401d-8b59-b9611c7e8bad
function interpolate_average_test(grid; teff, logg, feh, common_size=1000)
	logg_gr = grid.info[!, "logg"]
	teff_gr = grid.info[!, "teff"]
	feh_gr  = grid.info[!, "feh"]
	femask = trues(length(logg_gr)) #feh_gr .≈ feh_gr[argmin(abs.(feh .- feh_gr))]
	
	# read all average models and interpolate them to the same number of points
	models = Any[modelgrids.initial_model(grid, String(name))
					for name in grid.info[!, "name"]]
	r_models = [minimum(abs.(diff(m.z))) for m in models]
	#adiabats = [adbt(m) for m in models]

	ltscale = range(-8, 8, length=common_size) |> collect
	for i in eachindex(models)
		models[i] = @optical models[i] eos opa
	end
	models = [TSO.interpolate_to(m; τ=ltscale, in_log=true) for m in models]

	# now we interpolate all points to one common point, for every point
	scatter_int(v, x, y, z) = MUST.pyconvert(typeof(x),
		first(MUST.scipy_interpolate.griddata((teff_gr[femask], logg_gr[femask],  feh_gr[femask]), v, ([x], [y], [z]), method="linear"))
	)
	
	points = zeros(eltype(models[1].z), length(models), 3)
	z = zeros(eltype(models[1].z), common_size)
	t = zeros(eltype(models[1].z), common_size)
	d = zeros(eltype(models[1].z), common_size)
	
	for i in 1:common_size
		for j in eachindex(models)
			points[j, 1] = models[j].z[i]
			points[j, 2] = models[j].lnT[i]
			points[j, 3] = models[j].lnρ[i]
		end
		z[i] = scatter_int(points[femask, 1], teff, logg, feh)
		t[i] = scatter_int(points[femask, 2], teff, logg, feh)
		d[i] = scatter_int(points[femask, 3], teff, logg, feh)
	end
	
	r_target = scatter_int(r_models[femask], teff, logg, feh)
	npoints  = ceil(Int, abs(maximum(z) - minimum(z)) / r_target)

	# interpolate to equally spaced in z
	TSO.flip!(TSO.interpolate_to(
		Model1D(z=z, lnT=t, lnρ=d, logg=logg, τ=exp.(ltscale)), 
		z=collect(range(minimum(z), maximum(z), length=npoints))
	))
end

# ╔═╡ dded0e6d-d0f4-4eff-8a91-8ab32791c61c
m_ip = modelgrids.interpolate_average(
	staggergrid, eos,
	teff=randomgrid["teff", i_test], 
	logg=randomgrid["logg", i_test], 
	feh=randomgrid["feh", i_test],
)

# ╔═╡ 86d785dc-befc-47f4-aac5-d7e23652a714


# ╔═╡ 0ec025ac-a545-4dcb-94b4-8c366e604a17
md"An adiabat for this model would look like this"

# ╔═╡ bdf65b83-2b93-471b-922f-21464b4dcea1


# ╔═╡ 602803ec-1801-4b4e-a18d-4c41de0451ab
model_stagger_tau = """
-5.0000    3.52048E+03    3.24575E+10    0.00000E+00    6.95897E-01
     -4.9002    3.53195E+03    3.66174E+10    0.00000E+00    6.76037E-01
     -4.7999    3.54419E+03    4.13680E+10    0.00000E+00    6.57935E-01
     -4.7001    3.55721E+03    4.67822E+10    0.00000E+00    6.41492E-01
     -4.5998    3.57105E+03    5.29323E+10    0.00000E+00    6.26633E-01
     -4.5000    3.58572E+03    5.99309E+10    0.00000E+00    6.13354E-01
     -4.4001    3.60124E+03    6.79273E+10    0.00000E+00    6.01640E-01
     -4.2999    3.61760E+03    7.70710E+10    0.00000E+00    5.91493E-01
     -4.2001    3.63479E+03    8.75081E+10    0.00000E+00    5.82891E-01
     -4.0999    3.65281E+03    9.94247E+10    0.00000E+00    5.75761E-01
     -4.0000    3.67168E+03    1.13078E+11    0.00000E+00    5.69995E-01
     -3.9001    3.69135E+03    1.28768E+11    0.00000E+00    5.65460E-01
     -3.7999    3.71176E+03    1.46774E+11    0.00000E+00    5.62029E-01
     -3.7001    3.73283E+03    1.67363E+11    0.00000E+00    5.59638E-01
     -3.5999    3.75444E+03    1.90893E+11    0.00000E+00    5.58306E-01
     -3.5000    3.77645E+03    2.17818E+11    0.00000E+00    5.58117E-01
     -3.4001    3.79868E+03    2.48576E+11    0.00000E+00    5.59198E-01
     -3.2999    3.82100E+03    2.83497E+11    0.00000E+00    5.61655E-01
     -3.2001    3.84323E+03    3.22937E+11    0.00000E+00    5.65558E-01
     -3.0999    3.86528E+03    3.67461E+11    0.00000E+00    5.70957E-01
     -3.0000    3.88706E+03    4.17736E+11    0.00000E+00    5.77920E-01
     -2.9000    3.90849E+03    4.74346E+11    0.00000E+00    5.86492E-01
     -2.7999    3.92955E+03    5.37766E+11    0.00000E+00    5.96757E-01
     -2.7001    3.95021E+03    6.08656E+11    0.00000E+00    6.08779E-01
     -2.6000    3.97054E+03    6.88100E+11    0.00000E+00    6.22544E-01
     -2.5000    3.99066E+03    7.77438E+11    0.00000E+00    6.38016E-01
     -2.4000    4.01073E+03    8.78055E+11    0.00000E+00    6.55131E-01
     -2.2999    4.03100E+03    9.91291E+11    0.00000E+00    6.73759E-01
     -2.2001    4.05174E+03    1.11914E+12    0.00000E+00    6.93718E-01
     -2.1001    4.07333E+03    1.26473E+12    0.00000E+00    7.14746E-01
     -2.0000    4.09615E+03    1.43215E+12    0.00000E+00    7.36549E-01
     -1.8999    4.12064E+03    1.62566E+12    0.00000E+00    7.58815E-01
     -1.8000    4.14724E+03    1.84958E+12    0.00000E+00    7.81247E-01
     -1.7000    4.17638E+03    2.11027E+12    0.00000E+00    8.03549E-01
     -1.6001    4.20849E+03    2.41712E+12    0.00000E+00    8.25460E-01
     -1.5000    4.24400E+03    2.78203E+12    0.00000E+00    8.46802E-01
     -1.3999    4.28330E+03    3.21703E+12    0.00000E+00    8.67539E-01
     -1.3000    4.32685E+03    3.73639E+12    0.00000E+00    8.87665E-01
     -1.2000    4.37516E+03    4.36004E+12    0.00000E+00    9.07161E-01
     -1.1000    4.42891E+03    5.11445E+12    0.00000E+00    9.25993E-01
     -1.0000    4.48891E+03    6.03152E+12    0.00000E+00    9.44164E-01
     -0.9000    4.55610E+03    7.13516E+12    0.00000E+00    9.61737E-01
     -0.8000    4.63155E+03    8.44901E+12    0.00000E+00    9.78770E-01
     -0.7000    4.71640E+03    1.00417E+13    0.00000E+00    9.95258E-01
     -0.6000    4.81182E+03    1.20245E+13    0.00000E+00    1.01117E+00
     -0.5000    4.91916E+03    1.44861E+13    0.00000E+00    1.02649E+00
     -0.4000    5.04013E+03    1.73973E+13    0.00000E+00    1.04123E+00
     -0.3000    5.17687E+03    2.08332E+13    0.00000E+00    1.05536E+00
     -0.2000    5.33169E+03    2.51234E+13    0.00000E+00    1.06889E+00
     -0.1000    5.50683E+03    3.06881E+13    0.00000E+00    1.08181E+00
      0.0000    5.70407E+03    3.82205E+13    0.00000E+00    1.09407E+00
      0.1000    5.92383E+03    4.97700E+13    0.00000E+00    1.10616E+00
      0.2000    6.16502E+03    6.87113E+13    0.00000E+00    1.11903E+00
      0.3000    6.42576E+03    1.01397E+14    0.00000E+00    1.13352E+00
      0.4000    6.70395E+03    1.57348E+14    0.00000E+00    1.14972E+00
      0.5000    6.99708E+03    2.50833E+14    0.00000E+00    1.16723E+00
      0.6000    7.30120E+03    4.00832E+14    0.00000E+00    1.18491E+00
      0.7000    7.61019E+03    6.27517E+14    0.00000E+00    1.20156E+00
      0.8000    7.91553E+03    9.45449E+14    0.00000E+00    1.21612E+00
      0.9000    8.20706E+03    1.35463E+15    0.00000E+00    1.22789E+00
      1.0000    8.47527E+03    1.83660E+15    0.00000E+00    1.23624E+00
      1.1000    8.71380E+03    2.36141E+15    0.00000E+00    1.24088E+00
      1.2000    8.92098E+03    2.90109E+15    0.00000E+00    1.24186E+00
      1.3000    9.09954E+03    3.44038E+15    0.00000E+00    1.23954E+00
      1.3999    9.25489E+03    3.97931E+15    0.00000E+00    1.23441E+00
      1.5000    9.39308E+03    4.52831E+15    0.00000E+00    1.22689E+00
      1.6001    9.51944E+03    5.10247E+15    0.00000E+00    1.21728E+00
      1.7000    9.63805E+03    5.71715E+15    0.00000E+00    1.20599E+00
      1.8000    9.75192E+03    6.38727E+15    0.00000E+00    1.19341E+00
      1.8999    9.86319E+03    7.12750E+15    0.00000E+00    1.17982E+00
      2.0000    9.97332E+03    7.95177E+15    0.00000E+00    1.16519E+00
      2.1001    1.00835E+04    8.87601E+15    0.00000E+00    1.14922E+00
      2.2001    1.01943E+04    9.91547E+15    0.00000E+00    1.13238E+00
      2.2999    1.03064E+04    1.10886E+16    0.00000E+00    1.11466E+00
      2.4000    1.04202E+04    1.24142E+16    0.00000E+00    1.09615E+00
      2.5000    1.05362E+04    1.39159E+16    0.00000E+00    1.07710E+00
      2.6000    1.06543E+04    1.56164E+16    0.00000E+00    1.05760E+00
      2.7001    1.07747E+04    1.75426E+16    0.00000E+00    1.03741E+00
      2.7999    1.08973E+04    1.97253E+16    0.00000E+00    1.01592E+00
      2.9000    1.10225E+04    2.21996E+16    0.00000E+00    9.93776E-01
      3.0000    1.11501E+04    2.50034E+16    0.00000E+00    9.71223E-01
      3.0999    1.12804E+04    2.81869E+16    0.00000E+00    9.48223E-01
      3.2001    1.14133E+04    3.17983E+16    0.00000E+00    9.24106E-01
      3.2999    1.15486E+04    3.58890E+16    0.00000E+00    8.99319E-01
      3.4001    1.16863E+04    4.05252E+16    0.00000E+00    8.74476E-01
      3.5000    1.18269E+04    4.57809E+16    0.00000E+00    8.49563E-01
      3.5999    1.19701E+04    5.17316E+16    0.00000E+00    8.25113E-01
      3.7001    1.21159E+04    5.84654E+16    0.00000E+00    8.01058E-01
      3.7999    1.22645E+04    6.60893E+16    0.00000E+00    7.77811E-01
      3.9001    1.24158E+04    7.47227E+16    0.00000E+00    7.55199E-01
      4.0000    1.25701E+04    8.44967E+16    0.00000E+00    7.32756E-01
      4.0999    1.27271E+04    9.55497E+16    0.00000E+00    7.10665E-01
      4.2001    1.28868E+04    1.08036E+17    0.00000E+00    6.89607E-01
      4.2999    1.30495E+04    1.22146E+17    0.00000E+00    6.69654E-01
      4.4001    1.32155E+04    1.38090E+17    0.00000E+00    6.50448E-01
      4.5000    1.33843E+04    1.56098E+17    0.00000E+00    6.31527E-01
      4.5998    1.35563E+04    1.76449E+17    0.00000E+00    6.13193E-01
      4.7001    1.37317E+04    1.99460E+17    0.00000E+00    5.94336E-01
      4.7999    1.39107E+04    2.25485E+17    0.00000E+00    5.75421E-01
      4.9002    1.40928E+04    2.54865E+17    0.00000E+00    5.56634E-01
      5.0000    1.42786E+04    2.87999E+17    0.00000E+00    5.38068E-01
"""

# ╔═╡ a593e6fd-6702-4aaf-8917-64ae7290aeb5
open("test_model.txt", "w") do f
	write(f, model_stagger_tau)
end

# ╔═╡ 123b165f-0a6c-4894-9157-a538452cf139
data = readdlm("test_model.txt")

# ╔═╡ 77dbdf63-3679-483d-9bfc-d42c9d2b0d1f
model_as_input = """
-1.6569221976229014e9	26543.024116384462	-10.760158665552986
-1.6542982656688235e9	26477.33511424822	-10.769555789830097
-1.6516743337147455e9	26411.808680061342	-10.77895291410721
-1.6490504017606676e9	26346.444411498753	-10.788350038384323
-1.6464264698065896e9	26281.24190723089	-10.797747162661434
-1.6438025378525116e9	26216.20076692158	-10.807144286938547
-1.6411786058984334e9	26150.05785261726	-10.816642610055252
-1.6385546739443555e9	26083.486987775326	-10.826188726337156
-1.6359307419902775e9	26017.085594070777	-10.83573484261906
-1.6333068100361996e9	25950.853240076554	-10.845280958900961
-1.6306828780821216e9	25884.789495464032	-10.854827075182866
-1.6280589461280437e9	25818.80408614923	-10.86445863767648
-1.6254350141739657e9	25752.873518457538	-10.874198293988723
-1.6228110822198877e9	25687.11131021969	-10.883937950300965
-1.6201871502658098e9	25621.51703151524	-10.893677606613208
-1.6175632183117318e9	25556.09025352143	-10.903417262925451
-1.6149392863576536e9	25491.00772872878	-10.913222107464534
-1.6123153544035757e9	25426.48831620117	-10.923173524018498
-1.6096914224494977e9	25362.132206538525	-10.933124940572462
-1.6070674904954197e9	25297.938986410492	-10.943076357126424
-1.6044435585413418e9	25233.908243533107	-10.953027773680388
-1.601819626587264e9	25169.618314227675	-10.96302454880812
-1.5991956946331859e9	25104.429908376624	-10.973136000147402
-1.5965717626791081e9	25039.4103381513	-10.983247451486683
-1.59394783072503e9	24974.559166273513	-10.993358902825966
-1.591323898770952e9	24909.875956597592	-11.003470354165247
-1.588699966816874e9	24845.39299324014	-11.013651709931521
-1.5860760348627956e9	24781.140716742346	-11.023969648654298
-1.5834521029087179e9	24717.054602037053	-11.034287587377076
-1.58082817095464e9	24653.134219415886	-11.044605526099852
-1.578204239000562e9	24589.379140281733	-11.054923464822629
-1.575580307046484e9	24525.91808449689	-11.065345630197697
-1.572956375092406e9	24462.75348971558	-11.075875148626768
-1.570332443138328e9	24399.75157043625	-11.08640466705584
-1.56770851118425e9	24336.91190770067	-11.096934185484912
-1.5650845792301722e9	24274.23408362977	-11.107463703913982
-1.5624606472760942e9	24210.87836553865	-11.118119304288617
-1.5598367153220162e9	24147.40005485363	-11.128818274826463
-1.557212783367938e9	24084.088177449823	-11.139517245364306
-1.55458885141386e9	24020.942296957168	-11.15021621590215
-1.5519649194597821e9	23957.951242300565	-11.160929708123557
-1.5493409875057042e9	23894.984647881494	-11.171834049150565
-1.5467170555516262e9	23832.183543072722	-11.182738390177569
-1.5440931235975482e9	23769.547492932175	-11.193642731204577
-1.5414691916434703e9	23707.076063661178	-11.20454707223158
-1.5388452596893923e9	23644.89389951811	-11.21555705491827
-1.5362213277353144e9	23583.00709995364	-11.226679043327678
-1.5335973957812362e9	23521.28227937612	-11.237801031737085
-1.5309734638271585e9	23459.719013830963	-11.248923020146494
-1.5283495318730803e9	23398.316880473227	-11.2600450085559
-1.5257255999190023e9	23337.157572261232	-11.271378728564242
-1.5231016679649243e9	23276.158969897253	-11.28271463462393
-1.5204777360108464e9	23215.31980552301	-11.29405054068362
-1.5178538040567684e9	23154.63966239997	-11.305386446743308
-1.5152298721026907e9	23093.86747681357	-11.316837706392135
-1.5126059401486125e9	23033.073038160514	-11.328372835449557
-1.5099820081945345e9	22972.43864042632	-11.33990796450698
-1.507358076240456e9	22911.963862304434	-11.351443093564402
-1.5047341442863786e9	22851.815201422854	-11.363036239129721
-1.5021102123323007e9	22792.339058449477	-11.374808720327811
-1.4994862803782225e9	22733.017713313857	-11.3865812015259
-1.4968623484241445e9	22673.850763125618	-11.39835368272399
-1.4942384164700665e9	22614.83780604286	-11.41012616392208
-1.4916144845159886e9	22556.437125216235	-11.422126665931298
-1.4889905525619106e9	22498.188525207617	-11.434127799206376
-1.4863666206078327e9	22440.090343431504	-11.446128932481452
-1.4837426886537547e9	22382.14219145543	-11.458130065756526
-1.4811187566996768e9	22324.083628223987	-11.47029749653763
-1.4784948247455986e9	22266.122904874057	-11.482498755341231
-1.4758708927915206e9	22208.312666780643	-11.494700014144833
-1.4732469608374426e9	22150.652523234156	-11.506901272948433
-1.4706230288833647e9	22093.06767751545	-11.519257402770958
-1.4679990969292867e9	22035.605505755524	-11.531669937251204
-1.4653751649752088e9	21978.292788169714	-11.544082471731453
-1.4627512330211308e9	21921.129136040545	-11.556495006211703
-1.4601273010670528e9	21864.575400874237	-11.569076191946705
-1.457503369112975e9	21808.36021926344	-11.58172800170309
-1.454879437158897e9	21752.289570376688	-11.594379811459476
-1.4522555052048187e9	21696.36308261144	-11.607031621215864
-1.449631573250741e9	21640.51767208677	-11.619839437222767
-1.4470076412966628e9	21584.795468862674	-11.632698471127515
-1.4443837093425848e9	21529.216744827936	-11.645557505032265
-1.441759777388507e9	21473.781130537733	-11.658416538937013
-1.4391358454344292e9	21417.407919783902	-11.671417403269038
-1.436511913480351e9	21361.013850644995	-11.684440493797243
-1.433887981526273e9	21304.76827244604	-11.697463584325446
-1.431264049572195e9	21248.66672978274	-11.71049206944645
-1.428640117618117e9	21192.5560266398	-11.72372934375015
-1.4260161856640391e9	21136.593493311368	-11.73696661805385
-1.423392253709961e9	21080.778738529923	-11.750203892357549
-1.4207683217558832e9	21025.357085622767	-11.763505756738475
-1.418144389801805e9	20970.824365876615	-11.777003502110233
-1.415520457847727e9	20916.433085703204	-11.790501247481991
-1.412896525893649e9	20862.182878255717	-11.803998992853748
-1.4102725939395711e9	20807.967788372778	-11.81760768732839
-1.4076486619854932e9	20753.80518639048	-11.831309513908774
-1.4050247300314152e9	20699.783568260264	-11.845011340489155
-1.4024007980773373e9	20645.90256700488	-11.858713167069537
-1.399776866123259e9	20591.15285882386	-11.872567683535664
-1.397152934169181e9	20536.42966170098	-11.886440208086803
-1.3945290022151031e9	20481.851897343546	-11.90031273263794
-1.3919050702610252e9	20427.105712155222	-11.914234622711803
-1.3892811383069472e9	20371.74142930474	-11.928277222723258
-1.3866572063528693e9	20316.527202162568	-11.94231982273471
-1.3840332743987913e9	20261.462624027477	-11.956362422746164
-1.3814093424447136e9	20208.294441562066	-11.970359006714736
-1.3787854104906354e9	20155.91143192637	-11.984338541885545
-1.3761614785365574e9	20103.664207114438	-11.998318077056354
-1.3735375465824795e9	20051.528903071718	-12.012316626220262
-1.3709136146284013e9	19999.39898471745	-12.026420431335943
-1.3682896826743233e9	19947.40459360406	-12.040524236451622
-1.3656657507202454e9	19895.545377388105	-12.054628041567302
-1.3630418187661674e9	19843.19900710815	-12.06885948386278
-1.3604178868120894e9	19790.590186859474	-12.083173265868268
-1.3577939548580115e9	19738.120844522986	-12.097487047873754
-1.3551700229039335e9	19685.67755887234	-12.111827797760268
-1.3525460909498556e9	19632.503600651315	-12.126376642946719
-1.3499221589957776e9	19579.473273241292	-12.140925488133167
-1.3472982270416996e9	19526.586188673977	-12.155474333319617
-1.3446742950876217e9	19473.828541338265	-12.170375019254077
-1.3420503631335435e9	19421.207081676115	-12.185442782769027
-1.3394264311794655e9	19368.72781377719	-12.200510546283976
-1.3368024992253876e9	19316.597724239622	-12.215772942707611
-1.3341785672713096e9	19264.97611664265	-12.231381827098254
-1.3315546353172317e9	19213.4924624477	-12.246990711488898
-1.3289307033631535e9	19162.014821380824	-12.262629342796037
-1.3263067714090757e9	19109.96723651745	-12.2784284481756
-1.3236828394549978e9	19058.06102254407	-12.294227553555158
-1.3210589075009198e9	19006.29579547121	-12.310026658934717
-1.3184349755468416e9	18953.673204669052	-12.32599906135735
-1.3158110435927637e9	18901.187924550613	-12.341972923932683
-1.3131871116386857e9	18848.84798325911	-12.35794678650802
-1.3105631796846077e9	18796.612008264787	-12.37412198356412
-1.3079392477305298e9	18744.514228668402	-12.390329539874104
-1.3053153157764518e9	18692.560846298406	-12.406537096184088
-1.3026913838223739e9	18640.96226122961	-12.422942024117948
-1.300067451868296e9	18589.5665978802	-12.439403744977989
-1.297443519914218e9	18538.312639351352	-12.45586546583803
-1.29481958796014e9	18487.34449051468	-12.472509658409692
-1.292195656006062e9	18436.567310388076	-12.489218229182367
-1.2895717240519838e9	18385.929594424237	-12.505926799955045
-1.2869477920979059e9	18334.71077881126	-12.52276187260974
-1.284323860143828e9	18283.391061618353	-12.539639852342475
-1.28169992818975e9	18232.214990725937	-12.556517832075212
-1.279075996235672e9	18180.527894369847	-12.573546476171995
-1.276452064281594e9	18128.80788698884	-12.590616560005863
-1.273828132327516e9	18077.235012803194	-12.607686643839731
-1.2712042003734381e9	18026.238455419323	-12.6249965137815
-1.2685802684193602e9	17975.45830543557	-12.642346988870745
-1.2659563364652822e9	17924.82120379989	-12.65969746395999
-1.263332404511204e9	17874.896456893097	-12.677317949573997
-1.260708472557126e9	17825.126276067065	-12.694945808464547
-1.258084540603048e9	17775.442098202046	-12.712602602760255
-1.2554606086489701e9	17725.566144337467	-12.730441670287828
-1.2528366766948922e9	17675.830136965367	-12.748280737815401
-1.2502127447408142e9	17625.996818124906	-12.766184939543017
-1.2475888127867362e9	17575.833365762934	-12.78421892506175
-1.2449648808326583e9	17525.81267820336	-12.802252910580489
-1.2423409488785803e9	17475.562220562984	-12.82040011755507
-1.2397170169245024e9	17425.16620964659	-12.838635701377266
-1.2370930849704242e9	17374.915530701997	-12.856871285199462
-1.2344691530163462e9	17324.867310896832	-12.875315672301626
-1.2318452210622683e9	17274.97587338116	-12.893805979022279
-1.2292212891081903e9	17225.270399635745	-12.912328796761853
-1.2265973571541123e9	17176.03052123508	-12.931100322154814
-1.2239734252000344e9	17126.931399151683	-12.949871847547778
-1.2213494932459564e9	17077.971986867815	-12.96875609048052
-1.2187255612918785e9	17029.151752269954	-12.987776991610737
-1.2161016293378005e9	16980.47107846471	-13.006797892740954
-1.2134776973837225e9	16931.251532942224	-13.0259637455073
-1.2108537654296446e9	16882.029569629387	-13.045160705906216
-1.2082298334755664e9	16832.792034496728	-13.064400319479564
-1.2056059015214884e9	16783.133038833173	-13.083792281344007
-1.2029819695674105e9	16733.62054387163	-13.103184243208451
-1.2003580376133325e9	16684.39915771841	-13.12275920423519
-1.1977341056592546e9	16635.403778745193	-13.142436948381281
-1.1951101737051766e9	16586.562704108794	-13.162141663421412
-1.1924862417510986e9	16537.959195855994	-13.182090736316677
-1.1898623097970207e9	16489.49811018083	-13.202039809211943
-1.1872383778429427e9	16441.205202282512	-13.222137422864172
-1.1846144458888648e9	16393.0716393033	-13.242336977259502
-1.1819905139347866e9	16345.014934112876	-13.262560997868457
-1.1793665819807086e9	16296.620413747132	-13.282968388446232
-1.1767426500266306e9	16248.36918046989	-13.303375779024005
-1.1741187180725527e9	16199.894949526188	-13.323924775450816
-1.1714947861184747e9	16151.383737922284	-13.344544269592802
-1.1688708541643968e9	16102.932757435543	-13.365220224275605
-1.1662469222103188e9	16054.362627486707	-13.3860723188079
-1.1636229902562408e9	16005.938996163854	-13.406924413340196
-1.160999058302163e9	15957.651487319796	-13.428008430091442
-1.158375126348085e9	15909.507836408164	-13.449135022711873
-1.1557511943940067e9	15861.553888934226	-13.470399173565646
-1.1531272624399288e9	15813.792843812274	-13.491813418487713
-1.1505033304858508e9	15766.134881991746	-13.513261374896887
-1.1478793985317729e9	15718.377809341577	-13.53491084515155
-1.145255466577695e9	15670.765397256986	-13.556560315406216
-1.1426315346236172e9	15622.807863504107	-13.578367283465141
-1.140007602669539e9	15574.899848509438	-13.600205647484186
-1.137383670715461e9	15526.866733983434	-13.62216422887207
-1.134759738761383e9	15478.75467241394	-13.644223482604641
-1.132135806807305e9	15430.746452276118	-13.666358292526981
-1.1295118748532271e9	15382.76978047054	-13.688689703982732
-1.126887942899149e9	15334.957937880086	-13.71103408664969
-1.124264010945071e9	15287.683369478904	-13.733701361625556
-1.121640078990993e9	15240.554538994065	-13.756368636601424
-1.119016147036915e9	15193.422560870436	-13.77924199436494
-1.116392215082837e9	15146.406630569692	-13.802156727852996
-1.1137682831287594e9	15099.285607276532	-13.82521826873926
-1.1111443511746812e9	15052.177140662789	-13.848358583831985
-1.1085204192206032e9	15005.012299769589	-13.871608003135469
-1.1058964872665253e9	14957.784317767973	-13.894970950843604
-1.1032725553124473e9	14910.581328394917	-13.918414869752517
-1.100648623358369e9	14863.298301849714	-13.942009214648962
-1.0980246914042912e9	14816.13242492631	-13.9656699483535
-1.0954007594502132e9	14769.007269085927	-13.989551975698443
-1.0927768274961352e9	14722.012378682344	-14.013473343183325
-1.0901528955420573e9	14675.043955975472	-14.037642218005967
-1.0875289635879793e9	14628.222362773044	-14.061829585271438
-1.0849050316339014e9	14581.509185983097	-14.08626893586177
-1.0822810996798234e9	14534.939309647105	-14.110713585440823
-1.0796571677257454e9	14488.263773056966	-14.135388559973624
-1.0770332357716675e9	14441.738123966841	-14.160063534506424
-1.0744093038175893e9	14395.018941815206	-14.184973307821242
-1.0717853718635114e9	14348.449573769592	-14.209883989874712
-1.0691614399094335e9	14301.7057849011	-14.235034997723318
-1.0665375079553554e9	14255.110457501749	-14.260189033426755
-1.0639135760012774e9	14208.495125689222	-14.285634629301622
-1.0612896440471994e9	14162.024642310538	-14.311090921879561
-1.0586657120931215e9	14115.504896951757	-14.336831869217983
-1.0560417801390436e9	14069.120317004696	-14.362600920885496
-1.0534178481849654e9	14022.718238617876	-14.388641531357724
-1.0507939162308875e9	13976.444963800228	-14.414721705035165
-1.0481699842768095e9	13930.209474130717	-14.440990071762307
-1.0455460523227316e9	13884.064306484708	-14.467322182273733
-1.0429221203686537e9	13837.903467686916	-14.493826393881704
-1.0402981884145756e9	13791.784840003153	-14.52042597705265
-1.0376742564604976e9	13745.641868973187	-14.54717869072632
-1.0350503245064197e9	13699.507790240752	-14.57406563441032
-1.0324263925523417e9	13653.391898267471	-14.601079081774852
-1.0298024605982637e9	13607.228578859318	-14.628341192705562
-1.0271785286441857e9	13561.119084317515	-14.655729197405389
-1.0245545966901076e9	13514.97389383012	-14.683347050788075
-1.0219306647360297e9	13468.942457767746	-14.711017035781131
-1.0193067327819518e9	13422.867992038218	-14.738932450491717
-1.0166828008278738e9	13376.93838802725	-14.766905755874753
-1.0140588688737957e9	13331.125625035631	-14.795062760344077
-1.0114349369197178e9	13285.400312179832	-14.823335460326618
-1.0088110049656398e9	13239.751844620587	-14.85174188017958
-1.0061870730115619e9	13194.076153177952	-14.880331844539182
-1.0035631410574839e9	13148.480801348884	-14.908999091688544
-1.000939209103406e9	13102.492479472958	-14.937990442242814
-9.983152771493278e8	13056.566366119203	-14.967072444814958
-9.956913451952498e8	13010.557234997827	-14.996404085347859
-9.930674132411721e8	12964.628318281502	-15.02587538814408
-9.90443481287094e8	12918.789461986487	-15.055470013041003
-9.87819549333016e8	12872.984079020158	-15.08528971506615
-9.851956173789378e8	12827.32549068491	-15.115194480349741
-9.8257168542486e8	12781.871073863578	-15.145311876916319
-9.79947753470782e8	12736.53118842104	-15.175562148916057
-9.773238215167041e8	12691.30704590044	-15.205941608534268
-9.746998895626261e8	12645.774464075188	-15.236585544944953
-9.72075957608548e8	12600.187824212333	-15.267345690589107
-9.694520256544701e8	12554.296365055572	-15.298349667794263
-9.668280937003921e8	12508.386938269348	-15.329549639571113
-9.64204161746314e8	12462.529655774048	-15.36087651585175
-9.615802297922363e8	12416.742930209377	-15.392475535516168
-9.58956297838158e8	12371.079187119216	-15.424197379640596
-9.563323658840802e8	12325.526106673728	-15.456075298651799
-9.537084339300022e8	12280.277297471377	-15.488190235298855
-9.510845019759243e8	12235.188009610898	-15.520429065620299
-9.484605700218463e8	12190.207136581714	-15.552860089950622
-9.458366380677682e8	12144.767204276748	-15.585534644652304
-9.432127061136901e8	12099.152922611724	-15.618357997071577
-9.405887741596123e8	12053.217378196312	-15.651418077706944
-9.379648422055343e8	12007.236672928186	-15.684713530677554
-9.353409102514564e8	11961.340421069366	-15.718162810334668
-9.327169782973783e8	11915.580166403812	-15.751834099398334
-9.300930463433003e8	11869.963362255192	-15.785726951641786
-9.274691143892224e8	11824.585337107814	-15.81977391018002
-9.248451824351444e8	11779.570939390556	-15.85402930862756
-9.222212504810665e8	11734.68284504096	-15.888526323457826
-9.195973185269885e8	11689.592108390287	-15.923193393355762
-9.169733865729104e8	11644.067562604509	-15.95805707178191
-9.143494546188326e8	11597.955624620212	-15.993217302518428
-9.117255226647544e8	11551.780925898373	-16.028566333043344
-9.091015907106766e8	11505.610177796949	-16.06410708272214
-9.064776587565987e8	11459.639479308888	-16.09992233392476
-9.038537268025205e8	11413.85658375405	-16.135958776123385
-9.012297948484426e8	11368.384031038475	-16.172185833386308
-8.986058628943646e8	11323.346893923155	-16.20862007999447
-8.959819309402866e8	11278.628947105955	-16.24535260490071
-8.933579989862087e8	11233.416234877122	-16.28228219994691
-8.907340670321307e8	11187.657605000415	-16.319413255239468
-8.881101350780526e8	11141.263248254829	-16.356779240948725
-8.854862031239747e8	11094.549447950556	-16.39444830637428
-8.828622711698967e8	11048.016727703503	-16.43233742973493
-8.802383392158188e8	11001.723231904134	-16.470449752115798
-8.776144072617407e8	10955.673997632597	-16.50880066942878
-8.749904753076627e8	10910.3192771476	-16.54747656955193
-8.723665433535848e8	10865.338200271824	-16.58638626807116
-8.697426113995068e8	10820.381722147185	-16.625526740632452
-8.671186794454288e8	10775.01243635058	-16.664893651075094
-8.644947474913508e8	10728.199297313957	-16.704520713506074
-8.618708155372729e8	10680.77753092268	-16.744429443130628
-8.592468835831949e8	10633.511566617843	-16.7845938765904
-8.566229516291169e8	10586.558870197317	-16.825021483330058
-8.539990196750389e8	10539.98971182814	-16.865719757644566
-8.513750877209609e8	10494.17148582699	-16.906733495659793
-8.487511557668829e8	10448.862696278307	-16.94806916453179
-8.461272238128049e8	10403.867200652749	-16.98968062136523
-8.43503291858727e8	10357.987905917935	-17.031531192339962
-8.408793599046489e8	10310.589126692243	-17.073606211690986
-8.38255427950571e8	10262.045598436676	-17.11592873418043
-8.35631495996493e8	10213.917698767127	-17.158572640924206
-8.33007564042415e8	10166.208392836706	-17.20157438045643
-8.30383632088337e8	10119.342503077187	-17.24490650133724
-8.277597001342591e8	10073.131727816108	-17.288564049428196
-8.251357681801811e8	10027.380020938963	-17.33254159354201
-8.225118362261031e8	9981.73188291546	-17.376826220508306
-8.198879042720251e8	9934.871486465978	-17.421362679991244
-8.172639723179471e8	9884.986504812841	-17.466075987767443
-8.146400403638692e8	9835.450306348359	-17.51113723197436
-8.120161084097912e8	9786.434759444961	-17.55658856346559
-8.093921764557132e8	9738.49798364949	-17.60243966727566
-8.067682445016352e8	9691.30713216099	-17.64866556165755
-8.041443125475572e8	9644.633525548452	-17.695255817654402
-8.015203805934793e8	9598.178993091999	-17.74219813718798
-7.988964486394013e8	9549.67867385142	-17.789367118874136
-7.962725166853232e8	9498.978052404196	-17.836764626247643
-7.936485847312453e8	9447.90268887286	-17.884510937433625
-7.910246527771673e8	9397.770323881792	-17.932693335090313
-7.884007208230894e8	9348.727002147585	-17.98132253814487
-7.857767888690114e8	9300.445411406725	-18.03037828724733
-7.831528569149334e8	9252.649416073795	-18.079845783465593
-7.805289249608552e8	9204.168119595273	-18.129648691327027
-7.779049930067774e8	9152.886134430386	-18.179651454428434
-7.752810610526994e8	9099.575158432473	-18.22992402047253
-7.726571290986215e8	9047.215168612744	-18.280687713550428
-7.700331971445434e8	8996.166622836681	-18.33197022917921
-7.674092651904655e8	8946.046392173444	-18.383744187486137
-7.647853332363875e8	8896.551519744211	-18.435988423228018
-7.621614012823095e8	8846.064328181157	-18.488580137286988
-7.595374693282316e8	8792.053520679869	-18.541333954020224
-7.569135373741535e8	8736.386044325554	-18.59441737130056
-7.542896054200757e8	8681.902376488137	-18.648072112163096
-7.516656734659977e8	8628.806741622835	-18.702314530777652
-7.490417415119196e8	8576.712883703076	-18.757111539852414
-7.464178095578417e8	8525.120727972235	-18.812441072320446
-7.437938776037636e8	8469.690503326103	-18.867941175326276
-7.411699456496856e8	8410.196423532449	-18.923591862010866
-7.385460136956077e8	8351.99156094261	-18.97989440294013
-7.359220817415297e8	8295.56735780204	-19.036892513215975
-7.332981497874517e8	8240.472856255026	-19.09454339578671
-7.306742178333738e8	8186.056218797939	-19.152785795294065
-7.280502858792957e8	8123.9131125605845	-19.210827363103157
-7.254263539252177e8	8060.2738100014185	-19.269386332357538
-7.228024219711398e8	7998.37068469538	-19.328721384818465
-7.201784900170618e8	7938.525038503389	-19.3888617988857
-7.17554558062984e8	7879.986360263767	-19.449729540403773
-7.149306261089058e8	7813.248573187493	-19.51034926154061
-7.12306694154828e8	7743.797642047328	-19.57145572745157
-7.096827622007499e8	7676.242009853398	-19.63344977302368
-7.070588302466719e8	7610.870639810146	-19.69636037122803
-7.04434898292594e8	7543.1395015456	-19.7596864429049
-7.018109663385159e8	7465.932917178797	-19.822805472055016
-6.991870343844379e8	7389.875723278082	-19.886844537113433
-6.9656310243036e8	7316.487862875374	-19.95197484558604
-6.939391704762819e8	7238.883350815617	-20.01747032631639
-6.91315238522204e8	7150.861524733631	-20.082660392059367
-6.88691306568126e8	7065.424881165467	-20.14907589468058
-6.86067374614048e8	6980.22403003769	-20.21650549269341
-6.8344344265997e8	6879.799194116136	-20.28312396826528
-6.808195107058921e8	6780.93806289263	-20.351004481654265
-6.781955787518141e8	6677.294037351083	-20.4194704293321
-6.75571646797736e8	6560.173779488624	-20.48745501937455
-6.729477148436581e8	6443.393481634659	-20.556747047617726
-6.703237828895801e8	6308.126592644099	-20.62510220754509
-6.676998509355022e8	6167.134488427541	-20.694199909903958
-6.650759189814243e8	6013.61378615115	-20.763131606803316
-6.624519870273461e8	5845.405080232133	-20.832037476409365
-6.598280550732682e8	5663.861768691287	-20.900794270144623
-6.572041231191902e8	5470.072705593245	-20.970036065922308
-6.545801911651123e8	5261.93566302033	-21.03954564188824
-6.519562592110343e8	5046.680756105306	-21.110318212853446
-6.493323272569563e8	4970.013738803904	-21.211745322231305
-6.467083953028781e8	4968.6790776618245	-21.328800402667387
-6.440844633488003e8	4967.285384638134	-21.4458737786302
-6.414605313947222e8	4965.83684432481	-21.562968196851244
-6.388365994406444e8	4964.298871156412	-21.680080758676638
-6.362126674865664e8	4962.69204789339	-21.797214902915265
-6.335887355324883e8	4960.989087575589	-21.914367207551958
-6.309648035784104e8	4959.195720595501	-22.03154160186158
-6.283408716243324e8	4957.338494111696	-22.148743633200027
-6.257169396702545e8	4955.398672415624	-22.26597243778872
-6.230930077161765e8	4953.361266582824	-22.383230266048514
-6.204690757620984e8	4951.2469850388625	-22.500519250733838
-6.178451438080205e8	4949.021416035947	-22.61783472168661
-6.152212118539425e8	4946.664592923234	-22.73517561415528
-6.125972798998646e8	4944.211452384497	-22.852552004186386
-6.099733479457866e8	4941.6296346840945	-22.969964561669364
-6.073494159917085e8	4938.927008494477	-23.087409625470766
-6.047254840376306e8	4936.131801322018	-23.204897211591575
-6.021015520835526e8	4933.209503283825	-23.322428565960664
-5.994776201294746e8	4930.185750164002	-23.440006934099546
-5.968536881753967e8	4927.067705012637	-23.557635668032045
-5.942297562213186e8	4923.806514952332	-23.67531327119141
-5.916058242672406e8	4920.414946119612	-23.793039089829957
-5.889818923131627e8	4916.928177714937	-23.910822794468608
-5.863579603590847e8	4913.319775393436	-24.02866728878742
-5.837340284050068e8	4909.597300719793	-24.14657197426215
-5.811100964509287e8	4905.787639461223	-24.264545307756777
-5.784861644968507e8	4901.866314264924	-24.38258801147898
-5.758622325427728e8	4897.776666212008	-24.50068632225384
-5.732383005886948e8	4893.612691340182	-24.618866405589472
-5.706143686346169e8	4889.363971795063	-24.7371291261356
-5.679904366805388e8	4884.7701778542005	-24.85542615637516
-5.653665047264608e8	4879.83850841727	-24.973766510542355
-5.627425727723829e8	4874.548311380453	-25.092152833380624
-5.601186408183049e8	4869.052160221105	-25.210624804192076
-5.574947088642269e8	4863.426758770004	-25.32920288943753
-5.54870776910149e8	4857.678995927916	-25.447883987443703
-5.522468449560709e8	4851.76045716929	-25.566669920558223
-5.49622913001993e8	4845.702607648704	-25.685570771237117
-5.46998981047915e8	4839.523174516173	-25.80458768595709
-5.44375049093837e8	4833.187646367483	-25.923724273959635
-5.417511171397591e8	4826.743575055835	-26.042988712450338
-5.39127185185681e8	4820.214977823741	-26.16238721794018
-5.36503253231603e8	4813.569756919797	-26.281925419348717
-5.3387932127752507e8	4806.817553848283	-26.401595113909437
-5.312553893234471e8	4799.994204767456	-26.521413305347263
-5.286314573693691e8	4793.094868466879	-26.641379670888202
-5.260075254152912e8	4786.106375365246	-26.76149312893106
-5.233835934612131e8	4779.0780451268365	-26.881773015491053
-5.2075966150713515e8	4772.022250703489	-27.002210222109337
-5.181357295530572e8	4764.90540976237	-27.122811447051426
-5.155117975989792e8	4757.784319107395	-27.243581922634416
-5.128878656449013e8	4750.670642204395	-27.364521244897112
-5.102639336908232e8	4743.541100751149	-27.485640529097687
-5.0764000173674524e8	4736.1077723862645	-27.60686648597452
-5.050160697826673e8	4728.386987345977	-27.728224476742547
-5.023921378285892e8	4720.600452783972	-27.849758018700577
-4.997682058745113e8	4712.815597030494	-27.97148418357315
-4.971442739204333e8	4704.793650543198	-28.093355760828643
-4.945203419663554e8	4695.971772276196	-28.215271159330133
-4.9189641001227736e8	4686.408175823209	-28.33726859878935
-4.8927247805819935e8	4676.600450437998	-28.459450547584986
-4.866485461041214e8	4666.770868264993	-28.581882370028712
-4.840246141500434e8	4656.945070615391	-28.704555335427198
-4.8140068219596547e8	4647.143577149506	-28.82748645397351
-4.7877675024188745e8	4637.381284588184	-28.950669039838775
-4.761528182878095e8	4627.715315368478	-29.074122556013638
-4.735288863337315e8	4618.107654593208	-29.197831399050703
-4.709049543796536e8	4608.567629144745	-29.321799415407533
-4.682810224255755e8	4599.153541913276	-29.44603871029416
-4.6565709047149754e8	4589.883443105527	-29.570548099710614
-4.6303315851741946e8	4580.73634101331	-29.69532328150682
-4.6040922656334156e8	4571.729662725271	-29.820361790346645
-4.577852946092636e8	4562.904534789851	-29.945678401119515
-4.551613626551856e8	4554.199723278036	-30.071248064346722
-4.525374307011076e8	4545.3300623356745	-30.197012963993018
-4.4991349874702966e8	4535.798780722221	-30.322883618543848
-4.4728956679295164e8	4526.236517522449	-30.449000222774842
-4.446656348388737e8	4515.4724099110645	-30.575126887236465
-4.4204170288479567e8	4503.360644380699	-30.70127776381718
-4.394177709307177e8	4491.435499931887	-30.827795626481624
-4.3679383897663975e8	4479.705235945698	-30.954669928548213
-4.341699070225617e8	4468.145716410835	-31.08190389377922
-4.3154597506848377e8	4456.779941523108	-31.209482147892018
-4.2892204311440575e8	4445.7146068297625	-31.337446610686886
-4.2629811116032773e8	4434.861917473696	-31.46574939047654
-4.2367417920624983e8	4424.233667229592	-31.59440417955884
-4.210502472521718e8	4413.891086746771	-31.72341124578429
-4.184263152980938e8	4403.850243436089	-31.852766295052813
-4.1580238334401584e8	4394.074472843576	-31.982465082156853
-4.1317845138993794e8	4384.555164126903	-32.11248724866737
-4.105545194358599e8	4375.368920164431	-32.24285160696894
-4.0793058748178196e8	4365.663270664457	-32.37336820722442
-4.0530665552770394e8	4355.375782403684	-32.504040894608664
-4.0268272357362604e8	4344.148171093103	-32.634819792826946
-4.0005879161954796e8	4330.8181082147585	-32.76548294905631
-3.9743485966547e8	4317.777862431939	-32.89660194101207
-3.94810927711392e8	4305.046432349711	-33.02816486183873
-3.92186995757314e8	4292.624462117473	-33.160158665552984
"""

# ╔═╡ 20df94f0-1d93-4604-9c2c-193856d1f4f9
open("model_as_input.txt", "w") do f
	write(f, model_as_input)
end

# ╔═╡ 9b56e6d5-5d99-4104-bb80-41087f972a90
data_as_input = readdlm("model_as_input.txt")

# ╔═╡ 0b42ef0a-a6ad-47c6-b072-3eaa409dfb53
 TSO.pick_point(m_ip, 1)

# ╔═╡ 32b03e14-6765-4c63-8dab-0032d9272664
 TSO.pick_point(m_ip, length(m_ip.z))

# ╔═╡ 070c2ca2-092d-4e38-b8d7-cfa46f857d6d
ad = let
	m = TSO.flip(m_ip)
	s = TSO.pick_point(m, 1)
	e = TSO.pick_point(m, length(m.z))
	@show s.logg
	TSO.adiabat(
		s, e, eosE, dlnd=0.05, n_iter=50, 
		ee_min=exp.(lookup(eos, :lnEi, e.lnρ[1], e.lnT[1]))
	)
end

# ╔═╡ 250c95e4-e4c5-4272-b8d8-a1b4fd3d72d1
let
	plot(framestyle=:box, grid=false, legendforegroundcolor=nothing)
	
	scatter!(staggergrid["teff"], staggergrid["logg"])
	scatter!([randomgrid["teff", i_test]], [randomgrid["logg", i_test]])
	
	xflip!(true)
	yflip!(true)
end

# ╔═╡ e5c4f17b-da5a-4b72-8de1-6a215804e7b0
let
	plot(framestyle=:box, grid=false, legendforegroundcolor=nothing)
	
	#=for i in eachindex(edges)
		plot!(models_stagger[i].z, models_stagger[i].lnT, label=staggergrid["name", edges[i]])
	end=#

	plot!(m_ip.z, m_ip.lnρ)
	plot!(ad.z, ad.lnρ, label="adiabat")
	
	plot!()
end

# ╔═╡ 5cec8a09-c820-4de8-a6a1-a51432619006
let
	plot(framestyle=:box, grid=false, legendforegroundcolor=nothing)
	
	#=for i in eachindex(edges)
		plot!(models_stagger[i].z, models_stagger[i].lnT, label=staggergrid["name", edges[i]])
	end=#

	plot!(m_ip.z, m_ip.lnT)
	plot!(-ad.z, ad.lnT, label="adiabat")
	
	plot!()
end

# ╔═╡ 124f13ff-e0cc-4d85-9854-0b68c1061776
begin
	plot()
	
	plot!(data[:, 1], data[:, 2])
	
	for i in eachindex(edges)
		(i != length(edges)) && continue
		plot!(log10.(models_stagger[i].τ), exp.(models_stagger[i].lnT), 
				label=staggergrid["name", edges[i]])
	end

	plot!(xlim=(-8, 5), ylim=(2000, 15000))
end

# ╔═╡ a16c24bc-6dec-43fb-b1e9-5de00a7bc27f


# ╔═╡ Cell order:
# ╠═15678f68-882c-11ee-05ce-fd760daebd8d
# ╠═dc53b3e9-ab5f-4d14-828b-5fc961faf37d
# ╠═bc1caffd-1787-40b3-8ba0-68a3eafe09b3
# ╠═bf868bbc-a51f-4d3a-9357-64d2eb05addd
# ╠═8a44b83c-eeea-4224-a7ef-52d98895fa9f
# ╠═0bd5a63d-e047-493a-ba9c-e17b4de9e674
# ╠═9de39e0c-7525-42d3-86ac-2e5c06e37759
# ╠═4ce7b47f-f8b8-400e-9c41-4c1b0b09046a
# ╟─01d636c2-db4d-45af-8a04-0af50443fe64
# ╠═3b36e263-fef2-4c16-8c68-b20dbca3c34d
# ╠═7fe10125-30be-48d0-9b7a-5987e1718786
# ╠═c8578ef3-4eaa-4b51-8802-2557b78c6aa5
# ╟─6fe9c410-f5f4-459a-bfe7-7adde931838c
# ╠═fc9e065d-c19a-4edb-95a7-322ac5a575b4
# ╠═a2da7fef-8afb-4f73-898f-944122dff5f3
# ╟─171e7f10-8d6d-4670-9c92-5027efb0ce29
# ╠═fc5cc62a-0fa2-4b45-b511-ab6040cdeef3
# ╠═e3f4417e-9aa2-401d-8b59-b9611c7e8bad
# ╠═dded0e6d-d0f4-4eff-8a91-8ab32791c61c
# ╟─86d785dc-befc-47f4-aac5-d7e23652a714
# ╟─0ec025ac-a545-4dcb-94b4-8c366e604a17
# ╟─bdf65b83-2b93-471b-922f-21464b4dcea1
# ╟─602803ec-1801-4b4e-a18d-4c41de0451ab
# ╠═a593e6fd-6702-4aaf-8917-64ae7290aeb5
# ╟─123b165f-0a6c-4894-9157-a538452cf139
# ╟─77dbdf63-3679-483d-9bfc-d42c9d2b0d1f
# ╟─20df94f0-1d93-4604-9c2c-193856d1f4f9
# ╟─9b56e6d5-5d99-4104-bb80-41087f972a90
# ╠═0b42ef0a-a6ad-47c6-b072-3eaa409dfb53
# ╠═32b03e14-6765-4c63-8dab-0032d9272664
# ╠═070c2ca2-092d-4e38-b8d7-cfa46f857d6d
# ╠═250c95e4-e4c5-4272-b8d8-a1b4fd3d72d1
# ╠═e5c4f17b-da5a-4b72-8de1-6a215804e7b0
# ╠═5cec8a09-c820-4de8-a6a1-a51432619006
# ╠═124f13ff-e0cc-4d85-9854-0b68c1061776
# ╠═a16c24bc-6dec-43fb-b1e9-5de00a7bc27f
